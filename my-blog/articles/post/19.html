<!doctypehtml><html lang=en><meta charset=UTF-8><meta content="width=device-width,initial-scale=1"name=viewport><title>peng gan Blog</title><link href=styles.css rel=stylesheet><div class=header><a href=../../index.html>My Blog</a></div><div class=container><div class=subheader><h1>办公-NAS All in one</h1></div><div class=date id=lastModified></div><div class=content><div class=copy-container><p><a href=https://www.bilibili.com/video/BV1zu4y1g7LY>视频解说</a><p>一键部署NAS软件的脚本↓<p><a href=https://github.com/wukongdaily/diy-nas-onescript>https://github.com/wukongdaily/diy-nas-onescript</a><h2>1、安装必备的办公和远程控制软件</h2><p>WPS、QQ、微信、VScode、远程桌面RustDesk<h2>sudo apt-get install openssh-server<h2>3、安装虚拟机</h2><p>下载run格式的virtualbox 7<p><a href=https://www.virtualbox.org/wiki/Linux_Downloads>https://www.virtualbox.org/wiki/Linux_Downloads</a><p>其中，点击 <strong><span color="rgb(153, 27, 27)"fontsize=""style=color:#991b1b>【​All distributions】</span></strong><p>或者使用命令行下载和执行<p># 下载虚拟机安装包run，<a href=http://并保存为virtualbox7.run>并保存为</a><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>virtualbox7.run</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>wget -O virtualbox7.run https://download.virtualbox.org/virtualbox/7.0.12/VirtualBox-7.0.12-159484-Linux_amd64.run</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sh virtualbox7.run</code></pre><p>利用virtualbox自带的命令行将img 转换为vdi 方便导入虚拟机virtualbox7<h2>格式转换，超级快，一行代码搞定</h2><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>VBoxManage convertfromraw /path/to/source.img /path/to/target.vdi --format VDI</code></pre><p><strong>转换之后的vdi 要赋予最高权限 777 这样才可以确保VirtualBox 虚拟机调用</strong><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo chmod 777 /path/to/target.vdi</code></pre><h2>如何卸载VirtualBox 7 虚拟机</h2><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sh /opt/VirtualBox/uninstall.sh</code></pre><h2>安装虚拟机扩展包（USB设备）</h2><p>如何用命令行安装VirtualBox 7 扩展包（识别USB设备）<p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>wget https://download.virtualbox.org/virtualbox/7.0.12/Oracle_VM_VirtualBox_Extension_Pack-7.0.12.vbox-extpack</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>echo "y" | sudo VBoxManage extpack install --replace Oracle_VM_VirtualBox_Extension_Pack-7.0.12.vbox-extpack</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo VBoxManage list extpacks</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo groupadd usbfs</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo adduser $USER vboxusers</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo adduser $USER usbfs</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>echo "VM 扩展包安装完成,重启后才能生效。重启后USB才可以被虚拟机识别"</code></pre><h2>4、安装CasaOS（ Docker）</h2><p>准备工作：补全 udevil 和 mergerfs<h2>安装深度deepin缺少的依赖包udevil</h2><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>wget https://mirrors-i.tuna.tsinghua.edu.cn/debian/pool/main/u/udevil/udevil_0.4.4-3_amd64.deb</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo dpkg -i udevil_0.4.4-3_amd64.deb</code></pre><h2>安装深度deepin缺少的依赖包mergerfs</h2><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>wget https://mirrors.sohu.com/deepin/pool/main/m/mergerfs/mergerfs_2.24.2-4_amd64.deb</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo dpkg -i mergerfs_2.24.2-4_amd64.deb</code></pre><blockquote><p>一般在深度deepin系统下是无法使用CasaOS的会报错</blockquote><blockquote><p>准备工作：<p>由于CasaOS暂时没有适配深度deepin v23系统,但适配了标准的Debian 12。<p>而深度deepin系统恰好是基于debian 12制作的，嘿，那就先伪装一下debian 12/bookworm<p>从而让CasaOS的脚本顺利通过。</blockquote><p>暂时修改一下/etc/os-release 中的ID和VERSION_CODENAME<h4><mark data-color=inherit style=background-color:inherit;color:inherit;background-color:inherit;color:inherit;background-color:inherit;color:inherit;color:#d33d3d;background-color:inherit>备份一下配置文件</mark></h4><h2>备份一下原始文件</h2><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo cp /etc/os-release /etc/os-release.backup</code></pre><h4>修改系统名称和代号，待CasaOS安装成功后，还原回来。</h4><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo sed -i -e 's/^ID=.*$/ID=debian/' -e 's/^VERSION_CODENAME=.*$/VERSION_CODENAME=bookworm/' /etc/os-release</code></pre><p><img height=100% src=/upload/modify.png style=display:inline-block width=100%><blockquote><p>安装CasaOS需要的文件位于github，因此建议挂代理访问来加速下载过程。<p># 在深度deepin v23（debian 12） 系统下安装CasaOS</blockquote><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>wget -qO- https://get.casaos.io | sudo bashbase</code></pre><p><h2><mark data-color=inherit style=background-color:inherit;color:inherit;background-color:inherit;color:inherit;background-color:inherit;color:inherit;color:#d33d3d;background-color:inherit>安装成功后,记得将系统名称还原回来</mark></h2><h2>CasaOS安装成功之后,要记得还原配置文件</h2><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo mv /etc/os-release.backup /etc/os-release</code></pre><p><h2>如何卸载 CasaOS</h2><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>casaos-uninstall</code></pre><h2>配置docker国内镜像</h2><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo mkdir -p /etc/docker</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>{</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code> "registry-mirrors": [</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>"https://0b27f0a81a00f3560fbdc00ddd2f99e0.mirror.swr.myhuaweicloud.com",</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code> "https://ypzju6vq.mirror.aliyuncs.com",</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code> "https://registry.docker-cn.com",</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code> "http://hub-mirror.c.163.com",</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code> "https://docker.mirrors.ustc.edu.cn"</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code> ]</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>}</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>EOF</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo systemctl daemon-reload</code></pre><p><pre><button class=copy-button onclick=copyToClipboard(this)>复制</button><code>sudo systemctl restart docker</code></pre><p><p></div></div></div><script src=script.js></script><footer><a href=https://t.me/g9999_bot/ target=_blank>© 2024 peng gan. All rights reserved.</a></footer>